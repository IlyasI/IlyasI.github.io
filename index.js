//Background particle physics adapted from Florian Cordillot on CodePen: https://codepen.io/fcordillot/pen/ZaGgRy
$(document).ready(function(u){function v(){var e,o,t,n=Math.min(mouse.x-mouse.px,30),s=Math.min(mouse.y-mouse.py,30);for(i=0;i<vec_cells.length;i++){var r=vec_cells[i];for(j=0;j<r.length;j++){h(a=r[j],pen_size),mouse.down&&l(a,n,s,pen_size),void 0,o=.5*(e=a).up_left.xv+e.left.xv+.5*e.down_left.xv-.5*e.up_right.xv-e.right.xv-.5*e.down_right.xv,t=.5*e.up_left.yv+e.up.yv+.5*e.up_right.yv-.5*e.down_left.yv-e.down.yv-.5*e.down_right.yv,e.pressure=.25*(o+t)}}ctx.clearRect(0,0,canvas.width,canvas.height);var c=ctx.createLinearGradient(0,0,canvas.width,canvas.height);for(c.addColorStop("0","#4ed882"),c.addColorStop("0.4","#4eb5d8"),c.addColorStop("0.9","white"),ctx.strokeStyle=c,function(){for(i=0;i<particles.length;i++){var e=particles[i];if(0<=e.x&&e.x<canvas_width&&0<=e.y&&e.y<canvas_height){var o=parseInt(e.x/resolution),t=parseInt(e.y/resolution),n=vec_cells[o][t],s=e.x%resolution/resolution,r=e.y%resolution/resolution;e.xv+=(1-s)*n.xv*.05,e.yv+=(1-r)*n.yv*.05,e.xv+=s*n.right.xv*.05,e.yv+=s*n.right.yv*.05,e.xv+=r*n.down.xv*.05,e.yv+=r*n.down.yv*.05,e.x+=e.xv,e.y+=e.yv;var c=e.px-e.x,a=e.py-e.y,l=Math.sqrt(c*c+a*a),u=.5*Math.random();u<l?(ctx.lineWidth=1,ctx.beginPath(),ctx.moveTo(e.x,e.y),ctx.lineTo(e.px,e.py)):(ctx.beginPath(),ctx.moveTo(e.x,e.y),ctx.lineTo(e.x+u,e.y+u)),ctx.stroke(),e.px=e.x,e.py=e.y}else e.x=e.px=Math.random()*canvas_width,e.y=e.py=Math.random()*canvas_height,e.xv=0,e.yv=0;e.xv*=.5,e.yv*=.5}}(),i=0;i<vec_cells.length;i++){r=vec_cells[i];for(j=0;j<r.length;j++){var a;d(a=r[j])}}mouse.px=mouse.x,mouse.py=mouse.y,requestAnimationFrame(v)}function l(e,o,t,n){var s=e.x-mouse.x,i=e.y-mouse.y,r=Math.sqrt(i*i+s*s);if(r<n){r<4&&(r=n);var c=n/r;e.xv+=o*c,e.yv+=t*c}}function h(e,o){e.xv+=4*Math.random()-2,e.yv+=4*Math.random()-2}function d(e){e.xv+=.25*(.5*e.up_left.pressure+e.left.pressure+.5*e.down_left.pressure-.5*e.up_right.pressure-e.right.pressure-.5*e.down_right.pressure),e.yv+=.25*(.5*e.up_left.pressure+e.up.pressure+.5*e.up_right.pressure-.5*e.down_left.pressure-e.down.pressure-.5*e.down_right.pressure),e.xv*=.99,e.yv*=.99}function w(e,o,t){this.x=e,this.y=o,this.r=t,this.col=0,this.row=0,this.xv=0,this.yv=0,this.pressure=0}function m(e,o){this.x=this.px=e,this.y=this.py=o,this.xv=this.yv=0}function p(e){e.preventDefault(),mouse.down=!0}function _(){mouse.down=!1}function x(e){e.touches||(mouse.down=!1)}function y(e){mouse.down&&jQuery(".drag-me").fadeOut(1500),mouse.px=mouse.x,mouse.py=mouse.y;var o=canvas.getBoundingClientRect(),t=canvas.width/o.width,n=canvas.height/o.height;mouse.x=(e.clientX-o.left)*t,mouse.y=(e.clientY-o.top)*n}function g(e){mouse.down&&jQuery(".drag-me").fadeOut(1500),mouse.px=mouse.x,mouse.py=mouse.y;var o=canvas.getBoundingClientRect(),t=canvas.width/o.width,n=canvas.height/o.height;mouse.x=(e.touches[0].pageX-o.left)*t,mouse.y=(e.touches[0].pageY-o.top)*n}u.Fluid={initialize:function e(){for(mouse={x:0,y:0,px:0,py:0,down:!1},resolution=20,canvas_width=Math.round((window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)/resolution)*resolution,canvas_height=Math.round((window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)/resolution)*resolution,pen_size=40,num_cols=canvas_width/resolution,num_rows=canvas_height/resolution,speck_count=Math.min(Math.pow(canvas_width+canvas_height,1.15),6e3),vec_cells=[],particles=[],canvas=document.getElementById("c"),ctx=canvas.getContext("2d"),canvas.width=canvas_width,canvas.height=canvas_height,i=0;i<speck_count;i++)particles.push(new m(Math.random()*canvas_width,Math.random()*canvas_height));for(col=0;col<num_cols;col++)for(vec_cells[col]=[],row=0;row<num_rows;row++){var o=new w(col*resolution,row*resolution,resolution);vec_cells[col][row]=o,vec_cells[col][row].col=col,vec_cells[col][row].row=row}for(col=0;col<num_cols;col++)for(row=0;row<num_rows;row++){o=vec_cells[col][row];var t=0<=row-1?row-1:num_rows-1,n=0<=col-1?col-1:num_cols-1,s=col+1<num_cols?col+1:0,r=vec_cells[col][t],c=vec_cells[n][row],a=vec_cells[n][t],l=vec_cells[s][t];o.up=r,o.left=c,o.up_left=a,o.up_right=l,r.down=vec_cells[col][row],c.right=vec_cells[col][row],a.down_right=vec_cells[col][row],l.down_left=vec_cells[col][row]}u.addEventListener("resize",e),u.addEventListener("mousedown",p),u.addEventListener("touchstart",p),u.addEventListener("mouseup",_),u.addEventListener("touchend",x),canvas.addEventListener("mousemove",y),canvas.addEventListener("touchmove",g),u.onload=v}}}(window)),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,Fluid.initialize();
